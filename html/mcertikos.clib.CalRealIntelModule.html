<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>mcertikos.clib.CalRealIntelModule</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library mcertikos.clib.CalRealIntelModule</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#"><span class="id" title="library">AuxStateDataType</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="mcertikos.layerlib.Constant.html#"><span class="id" title="library">Constant</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Coqlib</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Maps</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Integers</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="mcertikos.layerlib.XOmega.html#"><span class="id" title="library">XOmega</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="mcertikos.clib.CLemmas.html#"><span class="id" title="library">CLemmas</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="mcertikos.invariants.INVLemmaIntel.html#"><span class="id" title="library">INVLemmaIntel</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Values</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">liblayers.compat.CompatGenSem</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="mcertikos.clib.VCGen.html#"><span class="id" title="library">VCGen</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="REAL_EPT"><span class="id" title="section">REAL_EPT</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Function</span> <span class="id" title="var">Calculate_EPDTE_at_j</span> (<span class="id" title="var">i</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">j</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">ept</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPT"><span class="id" title="definition">EPT</span></a>) : <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPT"><span class="id" title="definition">EPT</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="definition">ZMap.get</span> 0 <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPML4EValid"><span class="id" title="constructor">EPML4EValid</span></a> <span class="id" title="var">epdpt</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="definition">ZMap.get</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> <span class="id" title="var">epdpt</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPDPTEValid"><span class="id" title="constructor">EPDPTEValid</span></a> <span class="id" title="var">epdt</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">ZMap.set</span> 0 (<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPML4EValid"><span class="id" title="constructor">EPML4EValid</span></a> (<span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPDPTEValid"><span class="id" title="constructor">EPDPTEValid</span></a> (<span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#j"><span class="id" title="variable">j</span></a> (<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPDTEValid"><span class="id" title="constructor">EPDTEValid</span></a> (<span class="id" title="definition">ZMap.init</span> <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPTEUndef"><span class="id" title="constructor">EPTEUndef</span></a>)) <span class="id" title="var">epdt</span>)) <span class="id" title="var">epdpt</span>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="Calculate_EPDTE"><span class="id" title="definition">Calculate_EPDTE</span></a> (<span class="id" title="var">i</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">j</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">ept</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPT"><span class="id" title="definition">EPT</span></a>) : <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPT"><span class="id" title="definition">EPT</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#j"><span class="id" title="variable">j</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> ⇒ <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPDTE_at_j"><span class="id" title="definition">Calculate_EPDTE_at_j</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> 0 <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> ⇒ <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPDTE_at_j"><span class="id" title="definition">Calculate_EPDTE_at_j</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPDTE"><span class="id" title="definition">Calculate_EPDTE</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> <span class="id" title="var">k</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Function</span> <span class="id" title="var">Calculate_EPDPTE_at_i</span> (<span class="id" title="var">i</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">ept</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPT"><span class="id" title="definition">EPT</span></a>) : <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPT"><span class="id" title="definition">EPT</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="definition">ZMap.get</span> 0 <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPML4EValid"><span class="id" title="constructor">EPML4EValid</span></a> <span class="id" title="var">epdpt</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPDTE"><span class="id" title="definition">Calculate_EPDTE</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> 511 (<span class="id" title="definition">ZMap.set</span> 0 (<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPML4EValid"><span class="id" title="constructor">EPML4EValid</span></a> (<span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPDPTEValid"><span class="id" title="constructor">EPDPTEValid</span></a> (<span class="id" title="definition">ZMap.init</span> <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPDTEUndef"><span class="id" title="constructor">EPDTEUndef</span></a>)) <span class="id" title="var">epdpt</span>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="Calculate_EPDPTE"><span class="id" title="definition">Calculate_EPDPTE</span></a> (<span class="id" title="var">i</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">ept</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPT"><span class="id" title="definition">EPT</span></a>) : <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPT"><span class="id" title="definition">EPT</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> ⇒ <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPDPTE_at_i"><span class="id" title="definition">Calculate_EPDPTE_at_i</span></a> 0 <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> ⇒ <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPDPTE_at_i"><span class="id" title="definition">Calculate_EPDPTE_at_i</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPDPTE"><span class="id" title="definition">Calculate_EPDPTE</span></a> <span class="id" title="var">k</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#ept"><span class="id" title="variable">ept</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Calculate_EPTPool_at_i"><span class="id" title="definition">Calculate_EPTPool_at_i</span></a> (<span class="id" title="var">i</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">eptpool</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPTPool"><span class="id" title="definition">EPTPool</span></a>) : <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPTPool"><span class="id" title="definition">EPTPool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPDPTE"><span class="id" title="definition">Calculate_EPDPTE</span></a> 3 (<span class="id" title="definition">ZMap.set</span> 0 (<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPML4EValid"><span class="id" title="constructor">EPML4EValid</span></a> (<span class="id" title="definition">ZMap.init</span> <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPDPTEUndef"><span class="id" title="constructor">EPDPTEUndef</span></a>)) (<span class="id" title="definition">ZMap.get</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#eptpool"><span class="id" title="variable">eptpool</span></a>))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#eptpool"><span class="id" title="variable">eptpool</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="Calculate_EPTPool"><span class="id" title="definition">Calculate_EPTPool</span></a> (<span class="id" title="var">i</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">eptpool</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPTPool"><span class="id" title="definition">EPTPool</span></a>) : <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPTPool"><span class="id" title="definition">EPTPool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> ⇒ <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPTPool_at_i"><span class="id" title="definition">Calculate_EPTPool_at_i</span></a> 0 <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#eptpool"><span class="id" title="variable">eptpool</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> ⇒ <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPTPool_at_i"><span class="id" title="definition">Calculate_EPTPool_at_i</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPTPool"><span class="id" title="definition">Calculate_EPTPool</span></a> <span class="id" title="var">k</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#eptpool"><span class="id" title="variable">eptpool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="real_ept"><span class="id" title="definition">real_ept</span></a> (<span class="id" title="var">eptpool</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#EPTPool"><span class="id" title="definition">EPTPool</span></a>) := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_EPTPool"><span class="id" title="definition">Calculate_EPTPool</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<a class="idref" href="mcertikos.layerlib.Constant.html#NUM_VMS"><span class="id" title="abbreviation">NUM_VMS</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#239a40728d107295b3cb2c790f57f9e9"><span class="id" title="notation">-</span></a> 1)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#eptpool"><span class="id" title="variable">eptpool</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#REAL_EPT"><span class="id" title="section">REAL_EPT</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="REAL_VMCS"><span class="id" title="section">REAL_VMCS</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="write64_aux"><span class="id" title="definition">write64_aux</span></a> (<span class="id" title="var">enc</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">value</span>: <span class="id" title="inductive">Z64</span>) (<span class="id" title="var">d</span>: <span class="id" title="definition">ZMap.t</span> <span class="id" title="inductive">val</span>) : <span class="id" title="definition">ZMap.t</span> <span class="id" title="inductive">val</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">d1</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#enc"><span class="id" title="variable">enc</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int64.loword</span> (<span class="id" title="definition">Int64.repr</span> (<span class="id" title="definition">Z642Z</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#value"><span class="id" title="variable">value</span></a>)))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#d"><span class="id" title="variable">d</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">ZMap.set</span> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#enc"><span class="id" title="variable">enc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#a3448b794f7a26d611ad36492b5d640b"><span class="id" title="notation">+</span></a> 1) (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int64.hiword</span> (<span class="id" title="definition">Int64.repr</span> (<span class="id" title="definition">Z642Z</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#value"><span class="id" title="variable">value</span></a>)))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#d1"><span class="id" title="variable">d1</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="write64_block_aux"><span class="id" title="definition">write64_block_aux</span></a> (<span class="id" title="var">enc</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">value</span>: <span class="id" title="inductive">val</span>) (<span class="id" title="var">d</span>: <span class="id" title="definition">ZMap.t</span> <span class="id" title="inductive">val</span>) : <span class="id" title="definition">ZMap.t</span> <span class="id" title="inductive">val</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">d1</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#enc"><span class="id" title="variable">enc</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#value"><span class="id" title="variable">value</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#d"><span class="id" title="variable">d</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">ZMap.set</span> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#enc"><span class="id" title="variable">enc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#a3448b794f7a26d611ad36492b5d640b"><span class="id" title="notation">+</span></a> 1) <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#d1"><span class="id" title="variable">d1</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Calculate_VMCS_at_i"><span class="id" title="definition">Calculate_VMCS_at_i</span></a> (<span class="id" title="var">cpuid</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">curid</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">vm</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMCS"><span class="id" title="inductive">VMCS</span></a>) (<span class="id" title="var">vmi</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMXInfo"><span class="id" title="definition">VMXInfo</span></a>) (<span class="id" title="var">pml4ept_b</span> <span class="id" title="var">stack_b</span> <span class="id" title="var">idt_b</span> <span class="id" title="var">msr_bitmap_b</span> <span class="id" title="var">io_bitmap_b</span> <span class="id" title="var">host_rip_b</span>: <span class="id" title="definition">block</span>):=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm"><span class="id" title="variable">vm</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMCSValid"><span class="id" title="constructor">VMCSValid</span></a> <span class="id" title="var">revid</span> <span class="id" title="var">abrtid</span> <span class="id" title="var">m</span> ⇒<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">pinbased_ctls</span> := <span class="id" title="definition">ZMap.get</span> (<a class="idref" href="mcertikos.layerlib.Constant.html#VMX_INFO_PINBASED_CTLS"><span class="id" title="abbreviation">VMX_INFO_PINBASED_CTLS</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">procbased_ctls</span> := <span class="id" title="definition">ZMap.get</span> (<a class="idref" href="mcertikos.layerlib.Constant.html#VMX_INFO_PROCBASED_CTLS"><span class="id" title="abbreviation">VMX_INFO_PROCBASED_CTLS</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">procbased_ctls2</span> := <span class="id" title="definition">ZMap.get</span> (<a class="idref" href="mcertikos.layerlib.Constant.html#VMX_INFO_PROCBASED_CTLS2"><span class="id" title="abbreviation">VMX_INFO_PROCBASED_CTLS2</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">exit_ctls</span> := <span class="id" title="definition">ZMap.get</span> (<a class="idref" href="mcertikos.layerlib.Constant.html#VMX_INFO_EXIT_CTLS"><span class="id" title="abbreviation">VMX_INFO_EXIT_CTLS</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">entry_ctls</span> := <span class="id" title="definition">ZMap.get</span> (<a class="idref" href="mcertikos.layerlib.Constant.html#VMX_INFO_ENTRY_CTLS"><span class="id" title="abbreviation">VMX_INFO_ENTRY_CTLS</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cr0_ones_mask</span> := <span class="id" title="definition">ZMap.get</span> (<a class="idref" href="mcertikos.layerlib.Constant.html#VMX_INFO_CR0_ONES_MASK"><span class="id" title="abbreviation">VMX_INFO_CR0_ONES_MASK</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cr0_zeros_mask</span> := <span class="id" title="definition">ZMap.get</span> (<a class="idref" href="mcertikos.layerlib.Constant.html#VMX_INFO_CR0_ZEROS_MASK"><span class="id" title="abbreviation">VMX_INFO_CR0_ZEROS_MASK</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cr4_ones_mask</span> := <span class="id" title="definition">ZMap.get</span> (<a class="idref" href="mcertikos.layerlib.Constant.html#VMX_INFO_CR4_ONES_MASK"><span class="id" title="abbreviation">VMX_INFO_CR4_ONES_MASK</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cr4_zeros_mask</span> := <span class="id" title="definition">ZMap.get</span> (<a class="idref" href="mcertikos.layerlib.Constant.html#VMX_INFO_CR4_ZEROS_MASK"><span class="id" title="abbreviation">VMX_INFO_CR4_ZEROS_MASK</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m1</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_PIN_BASED_CTLS"><span class="id" title="abbreviation">C_VMCS_PIN_BASED_CTLS</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#pinbased_ctls"><span class="id" title="variable">pinbased_ctls</span></a>)) <span class="id" title="var">m</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m2</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_PRI_PROC_BASED_CTLS"><span class="id" title="abbreviation">C_VMCS_PRI_PROC_BASED_CTLS</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#procbased_ctls"><span class="id" title="variable">procbased_ctls</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m1"><span class="id" title="variable">m1</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m3</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_SEC_PROC_BASED_CTLS"><span class="id" title="abbreviation">C_VMCS_SEC_PROC_BASED_CTLS</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#procbased_ctls2"><span class="id" title="variable">procbased_ctls2</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m2"><span class="id" title="variable">m2</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m4</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_EXIT_CTLS"><span class="id" title="abbreviation">C_VMCS_EXIT_CTLS</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#exit_ctls"><span class="id" title="variable">exit_ctls</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m3"><span class="id" title="variable">m3</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m5</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_ENTRY_CTLS"><span class="id" title="abbreviation">C_VMCS_ENTRY_CTLS</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#entry_ctls"><span class="id" title="variable">entry_ctls</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m4"><span class="id" title="variable">m4</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m6</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_RIP"><span class="id" title="abbreviation">C_VMCS_HOST_RIP</span></a> (<span class="id" title="constructor">Vptr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#host_rip_b"><span class="id" title="variable">host_rip_b</span></a> <span class="id" title="definition">Int.zero</span>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m5"><span class="id" title="variable">m5</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m7</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_CR0"><span class="id" title="abbreviation">C_VMCS_HOST_CR0</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m6"><span class="id" title="variable">m6</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m8</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_CR3"><span class="id" title="abbreviation">C_VMCS_HOST_CR3</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m7"><span class="id" title="variable">m7</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m9</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_CR4"><span class="id" title="abbreviation">C_VMCS_HOST_CR4</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m8"><span class="id" title="variable">m8</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m10</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_ES_SELECTOR"><span class="id" title="abbreviation">C_VMCS_HOST_ES_SELECTOR</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#CPU_GDT_KDATA"><span class="id" title="abbreviation">CPU_GDT_KDATA</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m9"><span class="id" title="variable">m9</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m11</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_CS_SELECTOR"><span class="id" title="abbreviation">C_VMCS_HOST_CS_SELECTOR</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#CPU_GDT_KCODE"><span class="id" title="abbreviation">CPU_GDT_KCODE</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m10"><span class="id" title="variable">m10</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m12</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_SS_SELECTOR"><span class="id" title="abbreviation">C_VMCS_HOST_SS_SELECTOR</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#CPU_GDT_KDATA"><span class="id" title="abbreviation">CPU_GDT_KDATA</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m11"><span class="id" title="variable">m11</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m13</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_DS_SELECTOR"><span class="id" title="abbreviation">C_VMCS_HOST_DS_SELECTOR</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#CPU_GDT_KDATA"><span class="id" title="abbreviation">CPU_GDT_KDATA</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m12"><span class="id" title="variable">m12</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m14</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_FS_SELECTOR"><span class="id" title="abbreviation">C_VMCS_HOST_FS_SELECTOR</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#CPU_GDT_KDATA"><span class="id" title="abbreviation">CPU_GDT_KDATA</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m13"><span class="id" title="variable">m13</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m15</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_GS_SELECTOR"><span class="id" title="abbreviation">C_VMCS_HOST_GS_SELECTOR</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#CPU_GDT_KDATA"><span class="id" title="abbreviation">CPU_GDT_KDATA</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m14"><span class="id" title="variable">m14</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m16</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_TR_SELECTOR"><span class="id" title="abbreviation">C_VMCS_HOST_TR_SELECTOR</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#CPU_GDT_TSS"><span class="id" title="abbreviation">CPU_GDT_TSS</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m15"><span class="id" title="variable">m15</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m17</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_FS_BASE"><span class="id" title="abbreviation">C_VMCS_HOST_FS_BASE</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m16"><span class="id" title="variable">m16</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m18</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_GS_BASE"><span class="id" title="abbreviation">C_VMCS_HOST_GS_BASE</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m17"><span class="id" title="variable">m17</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m19</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_TR_BASE"><span class="id" title="abbreviation">C_VMCS_HOST_TR_BASE</span></a> (<span class="id" title="constructor">Vptr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#stack_b"><span class="id" title="variable">stack_b</span></a> (<span class="id" title="definition">Int.repr</span> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#curid"><span class="id" title="variable">curid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#88e34ed7a73f02772126289867960764"><span class="id" title="notation">×</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#PgSize"><span class="id" title="abbreviation">PgSize</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#a3448b794f7a26d611ad36492b5d640b"><span class="id" title="notation">+</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#TSS_OFFSET"><span class="id" title="abbreviation">TSS_OFFSET</span></a>))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m18"><span class="id" title="variable">m18</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m20</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_GDTR_BASE"><span class="id" title="abbreviation">C_VMCS_HOST_GDTR_BASE</span></a> (<span class="id" title="constructor">Vptr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#stack_b"><span class="id" title="variable">stack_b</span></a> (<span class="id" title="definition">Int.repr</span> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#curid"><span class="id" title="variable">curid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#88e34ed7a73f02772126289867960764"><span class="id" title="notation">×</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#PgSize"><span class="id" title="abbreviation">PgSize</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#a3448b794f7a26d611ad36492b5d640b"><span class="id" title="notation">+</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#GDT_OFFSET"><span class="id" title="abbreviation">GDT_OFFSET</span></a>))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m19"><span class="id" title="variable">m19</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m21</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_IDTR_BASE"><span class="id" title="abbreviation">C_VMCS_HOST_IDTR_BASE</span></a> (<span class="id" title="constructor">Vptr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#idt_b"><span class="id" title="variable">idt_b</span></a> <span class="id" title="definition">Int.zero</span>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m20"><span class="id" title="variable">m20</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m22</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_IA32_SYSENTER_CS"><span class="id" title="abbreviation">C_VMCS_HOST_IA32_SYSENTER_CS</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m21"><span class="id" title="variable">m21</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m23</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_IA32_SYSENTER_ESP"><span class="id" title="abbreviation">C_VMCS_HOST_IA32_SYSENTER_ESP</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m22"><span class="id" title="variable">m22</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m24</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_IA32_SYSENTER_EIP"><span class="id" title="abbreviation">C_VMCS_HOST_IA32_SYSENTER_EIP</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m23"><span class="id" title="variable">m23</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m25</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_aux"><span class="id" title="definition">write64_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_IA32_PERF_GLOBAL_CTRL"><span class="id" title="abbreviation">C_VMCS_HOST_IA32_PERF_GLOBAL_CTRL</span></a> (<span class="id" title="constructor">VZ64</span> 0) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m24"><span class="id" title="variable">m24</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m26</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_aux"><span class="id" title="definition">write64_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_IA32_PAT"><span class="id" title="abbreviation">C_VMCS_HOST_IA32_PAT</span></a> (<span class="id" title="constructor">VZ64</span> 0) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m25"><span class="id" title="variable">m25</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m27</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_aux"><span class="id" title="definition">write64_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_HOST_IA32_EFER"><span class="id" title="abbreviation">C_VMCS_HOST_IA32_EFER</span></a> (<span class="id" title="constructor">VZ64</span> 0) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m26"><span class="id" title="variable">m26</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m28</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_CR0"><span class="id" title="abbreviation">C_VMCS_GUEST_CR0</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.lor"><span class="id" title="definition">Z.lor</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#v0x60000010"><span class="id" title="abbreviation">v0x60000010</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#CR0_NE"><span class="id" title="abbreviation">CR0_NE</span></a>))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m27"><span class="id" title="variable">m27</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m29</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_CR3"><span class="id" title="abbreviation">C_VMCS_GUEST_CR3</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m28"><span class="id" title="variable">m28</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m30</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_CR4"><span class="id" title="abbreviation">C_VMCS_GUEST_CR4</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#CR4_VMXE"><span class="id" title="abbreviation">CR4_VMXE</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m29"><span class="id" title="variable">m29</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m31</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_DR7"><span class="id" title="abbreviation">C_VMCS_GUEST_DR7</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#v0x00000400"><span class="id" title="abbreviation">v0x00000400</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m30"><span class="id" title="variable">m30</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m32</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_aux"><span class="id" title="definition">write64_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_IA32_PAT"><span class="id" title="abbreviation">C_VMCS_GUEST_IA32_PAT</span></a> (<span class="id" title="constructor">VZ64</span> <a class="idref" href="mcertikos.layerlib.Constant.html#v0x7040600070406"><span class="id" title="abbreviation">v0x7040600070406</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m31"><span class="id" title="variable">m31</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m33</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_IA32_SYSENTER_CS"><span class="id" title="abbreviation">C_VMCS_GUEST_IA32_SYSENTER_CS</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m32"><span class="id" title="variable">m32</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m34</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_IA32_SYSENTER_ESP"><span class="id" title="abbreviation">C_VMCS_GUEST_IA32_SYSENTER_ESP</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m33"><span class="id" title="variable">m33</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m35</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_IA32_SYSENTER_EIP"><span class="id" title="abbreviation">C_VMCS_GUEST_IA32_SYSENTER_EIP</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m34"><span class="id" title="variable">m34</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m36</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_aux"><span class="id" title="definition">write64_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_IA32_DEBUGCTL"><span class="id" title="abbreviation">C_VMCS_GUEST_IA32_DEBUGCTL</span></a> (<span class="id" title="constructor">VZ64</span> 0) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m35"><span class="id" title="variable">m35</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m37</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_block_aux"><span class="id" title="definition">write64_block_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_EPTP"><span class="id" title="abbreviation">C_VMCS_EPTP</span></a> (<span class="id" title="constructor">Vptr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#pml4ept_b"><span class="id" title="variable">pml4ept_b</span></a> (<span class="id" title="definition">Int.repr</span> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cpuid"><span class="id" title="variable">cpuid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#88e34ed7a73f02772126289867960764"><span class="id" title="notation">×</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#EPT_SIZE"><span class="id" title="abbreviation">EPT_SIZE</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#a3448b794f7a26d611ad36492b5d640b"><span class="id" title="notation">+</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#EPTP_pml4"><span class="id" title="abbreviation">EPTP_pml4</span></a>))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m36"><span class="id" title="variable">m36</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m38</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_VPID"><span class="id" title="abbreviation">C_VMCS_VPID</span></a> <span class="id" title="definition">Vone</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m37"><span class="id" title="variable">m37</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m39</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_block_aux"><span class="id" title="definition">write64_block_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_MSR_BITMAP"><span class="id" title="abbreviation">C_VMCS_MSR_BITMAP</span></a> (<span class="id" title="constructor">Vptr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#msr_bitmap_b"><span class="id" title="variable">msr_bitmap_b</span></a> (<span class="id" title="definition">Int.repr</span> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cpuid"><span class="id" title="variable">cpuid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#88e34ed7a73f02772126289867960764"><span class="id" title="notation">×</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#PgSize"><span class="id" title="abbreviation">PgSize</span></a>))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m38"><span class="id" title="variable">m38</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m40</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_aux"><span class="id" title="definition">write64_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_LINK_POINTER"><span class="id" title="abbreviation">C_VMCS_LINK_POINTER</span></a> (<span class="id" title="constructor">VZ64</span> <a class="idref" href="mcertikos.layerlib.Constant.html#v0xffffffffffffffff"><span class="id" title="abbreviation">v0xffffffffffffffff</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m39"><span class="id" title="variable">m39</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m41</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_CR0_MASK"><span class="id" title="abbreviation">C_VMCS_CR0_MASK</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.lor"><span class="id" title="definition">Z.lor</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cr0_ones_mask"><span class="id" title="variable">cr0_ones_mask</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cr0_zeros_mask"><span class="id" title="variable">cr0_zeros_mask</span></a>))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m40"><span class="id" title="variable">m40</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m42</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_CR0_SHADOW"><span class="id" title="abbreviation">C_VMCS_CR0_SHADOW</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cr0_ones_mask"><span class="id" title="variable">cr0_ones_mask</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m41"><span class="id" title="variable">m41</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m43</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_CR4_MASK"><span class="id" title="abbreviation">C_VMCS_CR4_MASK</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.lor"><span class="id" title="definition">Z.lor</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cr4_ones_mask"><span class="id" title="variable">cr4_ones_mask</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cr4_zeros_mask"><span class="id" title="variable">cr4_zeros_mask</span></a>))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m42"><span class="id" title="variable">m42</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m44</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_CR4_SHADOW"><span class="id" title="abbreviation">C_VMCS_CR4_SHADOW</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cr4_ones_mask"><span class="id" title="variable">cr4_ones_mask</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m43"><span class="id" title="variable">m43</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m45</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_block_aux"><span class="id" title="definition">write64_block_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_IO_BITMAP_A"><span class="id" title="abbreviation">C_VMCS_IO_BITMAP_A</span></a> (<span class="id" title="constructor">Vptr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#io_bitmap_b"><span class="id" title="variable">io_bitmap_b</span></a> (<span class="id" title="definition">Int.repr</span> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cpuid"><span class="id" title="variable">cpuid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#88e34ed7a73f02772126289867960764"><span class="id" title="notation">×</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#PgSize"><span class="id" title="abbreviation">PgSize</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#88e34ed7a73f02772126289867960764"><span class="id" title="notation">×</span></a> 2))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m44"><span class="id" title="variable">m44</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m46</span> := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#write64_block_aux"><span class="id" title="definition">write64_block_aux</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_IO_BITMAP_B"><span class="id" title="abbreviation">C_VMCS_IO_BITMAP_B</span></a> (<span class="id" title="constructor">Vptr</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#io_bitmap_b"><span class="id" title="variable">io_bitmap_b</span></a> (<span class="id" title="definition">Int.repr</span> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cpuid"><span class="id" title="variable">cpuid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#88e34ed7a73f02772126289867960764"><span class="id" title="notation">×</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#PgSize"><span class="id" title="abbreviation">PgSize</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#88e34ed7a73f02772126289867960764"><span class="id" title="notation">×</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#a3448b794f7a26d611ad36492b5d640b"><span class="id" title="notation">+</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#PgSize"><span class="id" title="abbreviation">PgSize</span></a>))) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m45"><span class="id" title="variable">m45</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m47</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_ACTIVITY"><span class="id" title="abbreviation">C_VMCS_GUEST_ACTIVITY</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m46"><span class="id" title="variable">m46</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m48</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_INTERRUPTIBILITY"><span class="id" title="abbreviation">C_VMCS_GUEST_INTERRUPTIBILITY</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m47"><span class="id" title="variable">m47</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m49</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_GUEST_PENDING_DBG_EXCEPTIONS"><span class="id" title="abbreviation">C_VMCS_GUEST_PENDING_DBG_EXCEPTIONS</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m48"><span class="id" title="variable">m48</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m50</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#C_VMCS_ENTRY_INTR_INFO"><span class="id" title="abbreviation">C_VMCS_ENTRY_INTR_INFO</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m49"><span class="id" title="variable">m49</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">revid1</span> := <span class="id" title="definition">Vzero</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMCSValid"><span class="id" title="constructor">VMCSValid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#revid1"><span class="id" title="variable">revid1</span></a> <span class="id" title="var">abrtid</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#m50"><span class="id" title="variable">m50</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="Calculate_VMCSPool"><span class="id" title="definition">Calculate_VMCSPool</span></a> (<span class="id" title="var">i</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">cpuid</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">curid</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">vmcspool</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMCSPool"><span class="id" title="definition">VMCSPool</span></a>) (<span class="id" title="var">vmi</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMXInfo"><span class="id" title="definition">VMXInfo</span></a>) (<span class="id" title="var">pml4ept_b</span> <span class="id" title="var">stack_b</span> <span class="id" title="var">idt_b</span> <span class="id" title="var">msr_bitmap_b</span> <span class="id" title="var">io_bitmap_b</span> <span class="id" title="var">host_rip_b</span>: <span class="id" title="definition">block</span>):=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> ⇒ <span class="id" title="definition">ZMap.set</span> 0 (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMCS_at_i"><span class="id" title="definition">Calculate_VMCS_at_i</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cpuid"><span class="id" title="variable">cpuid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#curid"><span class="id" title="variable">curid</span></a> (<span class="id" title="definition">ZMap.get</span> 0 <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmcspool"><span class="id" title="variable">vmcspool</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#pml4ept_b"><span class="id" title="variable">pml4ept_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#stack_b"><span class="id" title="variable">stack_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#idt_b"><span class="id" title="variable">idt_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#msr_bitmap_b"><span class="id" title="variable">msr_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#io_bitmap_b"><span class="id" title="variable">io_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#host_rip_b"><span class="id" title="variable">host_rip_b</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmcspool"><span class="id" title="variable">vmcspool</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> ⇒ <span class="id" title="definition">ZMap.set</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMCS_at_i"><span class="id" title="definition">Calculate_VMCS_at_i</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cpuid"><span class="id" title="variable">cpuid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#curid"><span class="id" title="variable">curid</span></a> (<span class="id" title="definition">ZMap.get</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmcspool"><span class="id" title="variable">vmcspool</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#pml4ept_b"><span class="id" title="variable">pml4ept_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#stack_b"><span class="id" title="variable">stack_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#idt_b"><span class="id" title="variable">idt_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#msr_bitmap_b"><span class="id" title="variable">msr_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#io_bitmap_b"><span class="id" title="variable">io_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#host_rip_b"><span class="id" title="variable">host_rip_b</span></a>) (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMCSPool"><span class="id" title="definition">Calculate_VMCSPool</span></a> <span class="id" title="var">k</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cpuid"><span class="id" title="variable">cpuid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#curid"><span class="id" title="variable">curid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmcspool"><span class="id" title="variable">vmcspool</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#pml4ept_b"><span class="id" title="variable">pml4ept_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#stack_b"><span class="id" title="variable">stack_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#idt_b"><span class="id" title="variable">idt_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#msr_bitmap_b"><span class="id" title="variable">msr_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#io_bitmap_b"><span class="id" title="variable">io_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#host_rip_b"><span class="id" title="variable">host_rip_b</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="real_vmcs"><span class="id" title="definition">real_vmcs</span></a> (<span class="id" title="var">cpuid</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">curid</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) (<span class="id" title="var">vmcspool</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMCSPool"><span class="id" title="definition">VMCSPool</span></a>) (<span class="id" title="var">vmi</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMXInfo"><span class="id" title="definition">VMXInfo</span></a>) (<span class="id" title="var">pml4ept_b</span> <span class="id" title="var">stack_b</span> <span class="id" title="var">idt_b</span> <span class="id" title="var">msr_bitmap_b</span> <span class="id" title="var">io_bitmap_b</span> <span class="id" title="var">host_rip_b</span>: <span class="id" title="definition">block</span>):= <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMCSPool"><span class="id" title="definition">Calculate_VMCSPool</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<a class="idref" href="mcertikos.layerlib.Constant.html#NUM_VMS"><span class="id" title="abbreviation">NUM_VMS</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#239a40728d107295b3cb2c790f57f9e9"><span class="id" title="notation">-</span></a> 1)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#cpuid"><span class="id" title="variable">cpuid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#curid"><span class="id" title="variable">curid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmcspool"><span class="id" title="variable">vmcspool</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#pml4ept_b"><span class="id" title="variable">pml4ept_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#stack_b"><span class="id" title="variable">stack_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#idt_b"><span class="id" title="variable">idt_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#msr_bitmap_b"><span class="id" title="variable">msr_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#io_bitmap_b"><span class="id" title="variable">io_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#host_rip_b"><span class="id" title="variable">host_rip_b</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="real_vmcs_inject_neutral"><span class="id" title="lemma">real_vmcs_inject_neutral</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">vmid</span> <span class="id" title="var">curid</span> <span class="id" title="var">vm</span> <span class="id" title="var">vmi</span> <span class="id" title="var">n</span> <span class="id" title="var">pml4ept_b</span> <span class="id" title="var">stack_b</span> <span class="id" title="var">idt_b</span> <span class="id" title="var">msr_bitmap_b</span> <span class="id" title="var">io_bitmap_b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">host_rip_b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMCSPool_inject_neutral"><span class="id" title="definition">VMCSPool_inject_neutral</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm"><span class="id" title="variable">vm</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Mem.flat_inj</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#pml4ept_b"><span class="id" title="variable">pml4ept_b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="mcertikos.clib.CalRealIntelModule.html#pml4ept_b"><span class="id" title="variable">pml4ept_b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Mem.flat_inj</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#stack_b"><span class="id" title="variable">stack_b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="mcertikos.clib.CalRealIntelModule.html#stack_b"><span class="id" title="variable">stack_b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Mem.flat_inj</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#idt_b"><span class="id" title="variable">idt_b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="mcertikos.clib.CalRealIntelModule.html#idt_b"><span class="id" title="variable">idt_b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Mem.flat_inj</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#msr_bitmap_b"><span class="id" title="variable">msr_bitmap_b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="mcertikos.clib.CalRealIntelModule.html#msr_bitmap_b"><span class="id" title="variable">msr_bitmap_b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Mem.flat_inj</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#io_bitmap_b"><span class="id" title="variable">io_bitmap_b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="mcertikos.clib.CalRealIntelModule.html#io_bitmap_b"><span class="id" title="variable">io_bitmap_b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Mem.flat_inj</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#host_rip_b"><span class="id" title="variable">host_rip_b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="mcertikos.clib.CalRealIntelModule.html#host_rip_b"><span class="id" title="variable">host_rip_b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#cb2fd1306e4fe5d333fd9fb7e2c4a1d2"><span class="id" title="notation">≤</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmid"><span class="id" title="variable">vmid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#cb2fd1306e4fe5d333fd9fb7e2c4a1d2"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#NUM_VMS"><span class="id" title="abbreviation">NUM_VMS</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#cb2fd1306e4fe5d333fd9fb7e2c4a1d2"><span class="id" title="notation">≤</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#curid"><span class="id" title="variable">curid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#cb2fd1306e4fe5d333fd9fb7e2c4a1d2"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#num_proc"><span class="id" title="abbreviation">num_proc</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMCSPool_inject_neutral"><span class="id" title="definition">VMCSPool_inject_neutral</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmid"><span class="id" title="variable">vmid</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMCS_at_i"><span class="id" title="definition">Calculate_VMCS_at_i</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmid"><span class="id" title="variable">vmid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#curid"><span class="id" title="variable">curid</span></a> (<span class="id" title="definition">ZMap.get</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmid"><span class="id" title="variable">vmid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm"><span class="id" title="variable">vm</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmi"><span class="id" title="variable">vmi</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#pml4ept_b"><span class="id" title="variable">pml4ept_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#stack_b"><span class="id" title="variable">stack_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#idt_b"><span class="id" title="variable">idt_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#msr_bitmap_b"><span class="id" title="variable">msr_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#io_bitmap_b"><span class="id" title="variable">io_bitmap_b</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#host_rip_b"><span class="id" title="variable">host_rip_b</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm"><span class="id" title="variable">vm</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <a class="idref" href="mcertikos.clib.CLemmas.html#max_unsigned_val"><span class="id" title="lemma">max_unsigned_val</span></a>; <span class="id" title="tactic">intro</span> <span class="id" title="var">muval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMCSPool_inject_neutral"><span class="id" title="definition">VMCSPool_inject_neutral</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMCSPool_inject_neutral"><span class="id" title="definition">VMCSPool_inject_neutral</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="definition">ZMap.get</span> <span class="id" title="var">vmid0</span> <span class="id" title="var">vm</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">vmcs0_val</span>; <span class="id" title="tactic">symmetry</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Heqvmcs0_val</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="definition">ZMap.get</span> <span class="id" title="var">vmid</span> <span class="id" title="var">vm</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">vmcs_val</span>; <span class="id" title="tactic">symmetry</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Heqvmcs_val</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">Heqvmcs_val</span>, <span class="id" title="var">Heqvmcs0_val</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">vmcs_val&acute;</span> <span class="id" title="var">vmcs0_val&acute;</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Heqvmcs0_val</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Heqvmcs_val</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="definition">zeq</span> <span class="id" title="var">vmid0</span> <span class="id" title="var">vmid</span>); <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ZMap.gss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inv</span> <span class="id" title="var">Heqvmcs_val</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">eapply</span> <a class="idref" href="mcertikos.invariants.INVLemmaIntel.html#VMCS_inject_neutral_gss_Vint_same"><span class="id" title="lemma">VMCS_inject_neutral_gss_Vint_same</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" title="tactic">eapply</span> <a class="idref" href="mcertikos.invariants.INVLemmaIntel.html#VMCS_inject_neutral_gss_same"><span class="id" title="lemma">VMCS_inject_neutral_gss_same</span></a>); <span class="id" title="tactic">eauto</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">generalize</span> (<span class="id" title="var">H11</span> <span class="id" title="var">ofs</span>); <span class="id" title="tactic">intros</span> <span class="id" title="var">tmp</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">tmp</span>; <span class="id" title="tactic">eauto</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">discharge_cmp</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.add_0_r"><span class="id" title="lemma">Z.add_0_r</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.add_0_r"><span class="id" title="lemma">Z.add_0_r</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ZMap.gso</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#REAL_VMCS"><span class="id" title="section">REAL_VMCS</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="REAL_VMX"><span class="id" title="section">REAL_VMX</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Calculate_VMX_at_i"><span class="id" title="definition">Calculate_VMX_at_i</span></a> (<span class="id" title="var">vm</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMX"><span class="id" title="definition">VMX</span></a>): <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMX"><span class="id" title="definition">VMX</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vm1</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#VMX_G_RIP&acute;"><span class="id" title="abbreviation">VMX_G_RIP&acute;</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#v0xfff0"><span class="id" title="abbreviation">v0xfff0</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm"><span class="id" title="variable">vm</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vm2</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#VMX_VPID&acute;"><span class="id" title="abbreviation">VMX_VPID&acute;</span></a> <span class="id" title="definition">Vone</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm1"><span class="id" title="variable">vm1</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vm3</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#VMX_G_CR2&acute;"><span class="id" title="abbreviation">VMX_G_CR2&acute;</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm2"><span class="id" title="variable">vm2</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vm4</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#VMX_G_DR0&acute;"><span class="id" title="abbreviation">VMX_G_DR0&acute;</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm3"><span class="id" title="variable">vm3</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vm5</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#VMX_G_DR1&acute;"><span class="id" title="abbreviation">VMX_G_DR1&acute;</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm4"><span class="id" title="variable">vm4</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vm6</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#VMX_G_DR2&acute;"><span class="id" title="abbreviation">VMX_G_DR2&acute;</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm5"><span class="id" title="variable">vm5</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vm7</span> := <span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#VMX_G_DR3&acute;"><span class="id" title="abbreviation">VMX_G_DR3&acute;</span></a> <span class="id" title="definition">Vzero</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm6"><span class="id" title="variable">vm6</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.layerlib.Constant.html#VMX_G_DR6&acute;"><span class="id" title="abbreviation">VMX_G_DR6&acute;</span></a> (<span class="id" title="constructor">Vint</span> (<span class="id" title="definition">Int.repr</span> <a class="idref" href="mcertikos.layerlib.Constant.html#v0xffff0ff0"><span class="id" title="abbreviation">v0xffff0ff0</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm7"><span class="id" title="variable">vm7</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="Calculate_VMX"><span class="id" title="definition">Calculate_VMX</span></a> (<span class="id" title="var">i</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">vmxpool</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMXPool"><span class="id" title="definition">VMXPool</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#i"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> ⇒ <span class="id" title="definition">ZMap.set</span> 0 (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMX_at_i"><span class="id" title="definition">Calculate_VMX_at_i</span></a> (<span class="id" title="definition">ZMap.get</span> 0 <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmxpool"><span class="id" title="variable">vmxpool</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmxpool"><span class="id" title="variable">vmxpool</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span> ⇒ <span class="id" title="definition">ZMap.set</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMX_at_i"><span class="id" title="definition">Calculate_VMX_at_i</span></a> (<span class="id" title="definition">ZMap.get</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">k</span>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmxpool"><span class="id" title="variable">vmxpool</span></a>)) (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMX"><span class="id" title="definition">Calculate_VMX</span></a> <span class="id" title="var">k</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmxpool"><span class="id" title="variable">vmxpool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="real_vmx"><span class="id" title="definition">real_vmx</span></a> (<span class="id" title="var">vmxpool</span>: <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMXPool"><span class="id" title="definition">VMXPool</span></a>) := <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMX"><span class="id" title="definition">Calculate_VMX</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> (<a class="idref" href="mcertikos.layerlib.Constant.html#NUM_VMS"><span class="id" title="abbreviation">NUM_VMS</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#239a40728d107295b3cb2c790f57f9e9"><span class="id" title="notation">-</span></a> 1)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmxpool"><span class="id" title="variable">vmxpool</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="real_vmx_inject_neutral"><span class="id" title="lemma">real_vmx_inject_neutral</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">vmid</span> <span class="id" title="var">vm</span> <span class="id" title="var">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMXPool_inject_neutral"><span class="id" title="definition">VMXPool_inject_neutral</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm"><span class="id" title="variable">vm</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#cb2fd1306e4fe5d333fd9fb7e2c4a1d2"><span class="id" title="notation">≤</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmid"><span class="id" title="variable">vmid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl6/stdlib/Coq.ZArith.BinInt.html#cb2fd1306e4fe5d333fd9fb7e2c4a1d2"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="mcertikos.layerlib.Constant.html#NUM_VMS"><span class="id" title="abbreviation">NUM_VMS</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMXPool_inject_neutral"><span class="id" title="definition">VMXPool_inject_neutral</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="definition">ZMap.set</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmid"><span class="id" title="variable">vmid</span></a> (<a class="idref" href="mcertikos.clib.CalRealIntelModule.html#Calculate_VMX_at_i"><span class="id" title="definition">Calculate_VMX_at_i</span></a> (<span class="id" title="definition">ZMap.get</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vmid"><span class="id" title="variable">vmid</span></a> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm"><span class="id" title="variable">vm</span></a>)) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#vm"><span class="id" title="variable">vm</span></a>) <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#n"><span class="id" title="variable">n</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMXPool_inject_neutral"><span class="id" title="definition">VMXPool_inject_neutral</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="definition">zeq</span> <span class="id" title="var">vmid0</span> <span class="id" title="var">vmid</span>); <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ZMap.gss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="mcertikos.invariants.INVLemmaIntel.html#VMX_inject_neutral_gss_Vint"><span class="id" title="lemma">VMX_inject_neutral_gss_Vint</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="mcertikos.layerlib.AuxStateDataType.html#VMXPool_inject_neutral"><span class="id" title="definition">VMXPool_inject_neutral</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ZMap.gso</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="mcertikos.clib.CalRealIntelModule.html#REAL_VMX"><span class="id" title="section">REAL_VMX</span></a>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>